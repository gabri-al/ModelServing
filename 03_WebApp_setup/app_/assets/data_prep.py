## Logic to process input data according to the model expected input
import pandas as pd

encoding_mapping = {
    'host_identity_verified': 
      {'unconfirmed': '1', 'verified': '2'},
    'neighbourhood_group': 
      {'Bronx': '1', 'Brooklyn': '2', 'Manhattan': '3', 'Queens': '4', 'Staten Island': '5'},
    'neighbourhood': 
      {'Allerton': '1', 'Arden Heights': '2', 'Arrochar': '3', 'Arverne': '4', 'Astoria': '5', 'Bath Beach': '6', 'Battery Park City': '7', 'Bay Ridge': '8', 'Bay Terrace': '9', 'Bay Terrace, Staten Island': '10', 'Baychester': '11', 'Bayside': '12', 'Bayswater': '13', 'Bedford-Stuyvesant': '14', 'Belle Harbor': '15', 'Bellerose': '16', 'Belmont': '17', 'Bensonhurst': '18', 'Bergen Beach': '19', 'Boerum Hill': '20', 'Borough Park': '21', 'Breezy Point': '22', 'Briarwood': '23', 'Brighton Beach': '24', 'Bronxdale': '25', 'Brooklyn Heights': '26', 'Brownsville': '27', "Bull's Head": '28', 'Bushwick': '29', 'Cambria Heights': '30', 'Canarsie': '31', 'Carroll Gardens': '32', 'Castle Hill': '33', 'Castleton Corners': '34', 'Chelsea': '35', 'Chelsea, Staten Island': '36', 'Chinatown': '37', 'City Island': '38', 'Civic Center': '39', 'Claremont Village': '40', 'Clason Point': '41', 'Clifton': '42', 'Clinton Hill': '43', 'Co-op City': '44', 'Cobble Hill': '45', 'College Point': '46', 'Columbia St': '47', 'Concord': '48', 'Concourse': '49', 'Concourse Village': '50', 'Coney Island': '51', 'Corona': '52', 'Crown Heights': '53', 'Cypress Hills': '54', 'DUMBO': '55', 'Ditmars Steinway': '56', 'Dongan Hills': '57', 'Douglaston': '58', 'Downtown Brooklyn': '59', 'Dyker Heights': '60', 'East Elmhurst': '61', 'East Flatbush': '62', 'East Harlem': '63', 'East Morrisania': '64', 'East New York': '65', 'East Village': '66', 'Eastchester': '67', 'Edenwald': '68', 'Edgemere': '69', 'Elmhurst': '70', 'Eltingville': '71', 'Emerson Hill': '72', 'Far Rockaway': '73', 'Fieldston': '74', 'Financial District': '75', 'Flatbush': '76', 'Flatiron District': '77', 'Flatlands': '78', 'Flushing': '79', 'Fordham': '80', 'Forest Hills': '81', 'Fort Greene': '82', 'Fort Hamilton': '83', 'Fort Wadsworth': '84', 'Fresh Meadows': '85', 'Gerritsen Beach': '86', 'Glen Oaks': '87', 'Glendale': '88', 'Gowanus': '89', 'Gramercy': '90', 'Graniteville': '91', 'Grant City': '92', 'Gravesend': '93', 'Great Kills': '94', 'Greenpoint': '95', 'Greenwich Village': '96', 'Grymes Hill': '97', 'Harlem': '98', "Hell's Kitchen": '99', 'Highbridge': '100', 'Hollis': '101', 'Holliswood': '102', 'Howard Beach': '103', 'Howland Hook': '104', 'Huguenot': '105', 'Hunts Point': '106', 'Inwood': '107', 'Jackson Heights': '108', 'Jamaica': '109', 'Jamaica Estates': '110', 'Jamaica Hills': '111', 'Kensington': '112', 'Kew Gardens': '113', 'Kew Gardens Hills': '114', 'Kingsbridge': '115', 'Kips Bay': '116', 'Laurelton': '117', 'Lighthouse Hill': '118', 'Little Italy': '119', 'Little Neck': '120', 'Long Island City': '121', 'Longwood': '122', 'Lower East Side': '123', 'Manhattan Beach': '124', 'Marble Hill': '125', 'Mariners Harbor': '126', 'Maspeth': '127', 'Melrose': '128', 'Middle Village': '129', 'Midland Beach': '130', 'Midtown': '131', 'Midwood': '132', 'Mill Basin': '133', 'Morningside Heights': '134', 'Morris Heights': '135', 'Morris Park': '136', 'Morrisania': '137', 'Mott Haven': '138', 'Mount Eden': '139', 'Mount Hope': '140', 'Murray Hill': '141', 'Navy Yard': '142', 'Neponsit': '143', 'New Brighton': '144', 'New Dorp': '145', 'New Dorp Beach': '146', 'New Springville': '147', 'NoHo': '148', 'Nolita': '149', 'North Riverdale': '150', 'Norwood': '151', 'Oakwood': '152', 'Olinville': '153', 'Ozone Park': '154', 'Park Slope': '155', 'Parkchester': '156', 'Pelham Bay': '157', 'Pelham Gardens': '158', 'Port Morris': '159', 'Port Richmond': '160', "Prince's Bay": '161', 'Prospect Heights': '162', 'Prospect-Lefferts Gardens': '163', 'Queens Village': '164', 'Randall Manor': '165', 'Red Hook': '166', 'Rego Park': '167', 'Richmond Hill': '168', 'Richmondtown': '169', 'Ridgewood': '170', 'Riverdale': '171', 'Rockaway Beach': '172', 'Roosevelt Island': '173', 'Rosebank': '174', 'Rosedale': '175', 'Rossville': '176', 'Schuylerville': '177', 'Sea Gate': '178', 'Sheepshead Bay': '179', 'Shore Acres': '180', 'Silver Lake': '181', 'SoHo': '182', 'Soundview': '183', 'South Beach': '184', 'South Ozone Park': '185', 'South Slope': '186', 'Springfield Gardens': '187', 'Spuyten Duyvil': '188', 'St. Albans': '189', 'St. George': '190', 'Stapleton': '191', 'Stuyvesant Town': '192', 'Sunnyside': '193', 'Sunset Park': '194', 'Theater District': '195', 'Throgs Neck': '196', 'Todt Hill': '197', 'Tompkinsville': '198', 'Tottenville': '199', 'Tremont': '200', 'Tribeca': '201', 'Two Bridges': '202', 'Unionport': '203', 'University Heights': '204', 'Upper East Side': '205', 'Upper West Side': '206', 'Van Nest': '207', 'Vinegar Hill': '208', 'Wakefield': '209', 'Washington Heights': '210', 'West Brighton': '211', 'West Farms': '212', 'West Village': '213', 'Westchester Square': '214', 'Westerleigh': '215', 'Whitestone': '216', 'Williamsbridge': '217', 'Williamsburg': '218', 'Willowbrook': '219', 'Windsor Terrace': '220', 'Woodhaven': '221', 'Woodlawn': '222', 'Woodrow': '223', 'Woodside': '224'},
    'instant_bookable': {'FALSE': '1', 'TRUE': '2'},
    'cancellation_policy': {'flexible': '1', 'moderate': '2', 'strict': '3'},
    'room_type': {'Entire home/apt': '1', 'Hotel room': '2', 'Private room': '3', 'Shared room': '4'}
  }

def prepare_input(input_df):
  pandas_df = input_df.copy()
  
  ## Encode data
  for k, encod_dict in encoding_mapping.items():
    # Create a new column with the encoded values using the mapping dictionary
    pandas_df[f"{k}_encoded"] = pandas_df[k].replace(encod_dict)
    # Convert the new column to float type
    pandas_df[f"{k}_encoded"] = pandas_df[f"{k}_encoded"].astype(float)
    # Drop transformed column
    pandas_df.drop(k, axis=1, inplace=True)

  return pandas_df